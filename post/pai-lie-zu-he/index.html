<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>排列组合 | 独木舟游四海</title>
<link rel="shortcut icon" href="https://938650141.github.io/favicon.ico?v=1607086301768">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://938650141.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="排列组合 | 独木舟游四海 - Atom Feed" href="https://938650141.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="n个物品分给m个人，每人最少分1个
C(n-1,m-1)，n-1个空选出m-1个即可
#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[1000005];
int inv[1..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://938650141.github.io">
  <img class="avatar" src="https://938650141.github.io/images/avatar.png?v=1607086301768" alt="">
  </a>
  <h1 class="site-title">
    独木舟游四海
  </h1>
  <p class="site-description">
    温故而知新
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              排列组合
            </h2>
            <div class="post-info">
              <span>
                2020-12-02
              </span>
              <span>
                20 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>n个物品分给m个人，每人最少分1个<br>
C(n-1,m-1)，n-1个空选出m-1个即可</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[1000005];
int inv[1000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=1000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=1000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,m;
		scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
		int ans=1;
		ans=((long long)f[n-1]*inv[m-1])%mod;
		ans=((long long)ans*inv[n-m])%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品分给m个人，允许为空<br>
则人为地填充n个物品，使其满足隔板法要求，再人为地将每个人扣除一个物品，是等价的效果<br>
C(n+m-1,m-1)</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,m;
		scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
		int ans=1;
		ans=((long long)f[n+m-1]*inv[m-1])%mod;
		ans=((long long)ans*inv[n])%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品，m个人，分配m个、m+1个……n个物品给m个人的方案数<br>
<img src="https://938650141.github.io/post-images/1606985887150.jpg" alt="主条目：朱世杰恒等式" loading="lazy"></p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,m;
		scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
		int ans=1;
		ans=((long long)f[n]*inv[m])%mod;
		ans=((long long)ans*inv[n-m])%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>拿出0个或1个或2个……或n个来分给m个人<br>
同样根据上面的式子</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,m;
		scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
		int ans=1;
		ans=((long long)f[n+m]*inv[m])%mod;
		ans=((long long)ans*inv[n])%mod;
		//ans=(ans-1+mod)%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品分配给3个人，每个人带限制[1,a+1),[1,b+1),[1,c+1)<br>
利用容斥</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int C(int a,int b){
	if(b&gt;a) return 0;
	int ans=1;
	ans=((long long)f[a]*inv[b])%mod;
	ans=((long long)ans*inv[a-b])%mod;
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,a,b,c;
		scanf(&quot;%d%d%d%d&quot;,&amp;n,&amp;a,&amp;b,&amp;c);
		int ans=0;
		ans=(ans+C(n-1,2))%mod;
		ans=(ans-C(n-a-1,2))%mod;
		ans=(ans-C(n-b-1,2))%mod;
		ans=(ans-C(n-c-1,2))%mod;
		ans=(ans+C(n-a-b-1,2))%mod;
		ans=(ans+C(n-a-c-1,2))%mod;
		ans=(ans+C(n-b-c-1,2))%mod;
		ans=(ans-C(n-a-b-c-1,2))%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品分配给3个人，限制[0,a+1),[0,b+1),[0,c+1)</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int C(int a,int b){
	if(b&gt;a) return 0;
	int ans=1;
	ans=((long long)f[a]*inv[b])%mod;
	ans=((long long)ans*inv[a-b])%mod;
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,a,b,c;
		scanf(&quot;%d%d%d%d&quot;,&amp;n,&amp;a,&amp;b,&amp;c);
		int ans=0;
		ans=(ans+C(n+3-1,2))%mod;
		ans=(ans-C(n-a-1+3-1,2)+mod)%mod;
		ans=(ans-C(n-b-1+3-1,2)+mod)%mod;
		ans=(ans-C(n-c-1+3-1,2)+mod)%mod;
		ans=(ans+C(n-a-1-b-1+3-1,2))%mod;
		ans=(ans+C(n-a-1-c-1+3-1,2))%mod;
		ans=(ans+C(n-b-1-c-1+3-1,2))%mod;
		ans=(ans-C(n-a-1-b-1-c-1+3-1,2)+mod)%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品，3个人，每次拿出3~n个物品分给每个人，限制限制[1,a+1),[1,b+1),[1,c+1)</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int C(int a,int b){
	if(b&gt;a) return 0;
	int ans=1;
	ans=((long long)f[a]*inv[b])%mod;
	ans=((long long)ans*inv[a-b])%mod;
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,a,b,c;
		scanf(&quot;%d%d%d%d&quot;,&amp;n,&amp;a,&amp;b,&amp;c);
		int ans=0;
		ans=(ans+C(n,3))%mod;
		ans=(ans-C(n-a,3)+mod)%mod;
		ans=(ans-C(n-b,3)+mod)%mod;
		ans=(ans-C(n-c,3)+mod)%mod;
		ans=(ans+C(n-a-b,3))%mod;
		ans=(ans+C(n-a-c,3))%mod;
		ans=(ans+C(n-b-c,3))%mod;
		ans=(ans-C(n-a-b-c,3)+mod)%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品，3个人，每次拿出3~n个物品分给每个人，限制限制[0,a+1),[0,b+1),[0,c+1)</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

int C(int a,int b){
	if(b&gt;a) return 0;
	int ans=1;
	ans=((long long)f[a]*inv[b])%mod;
	ans=((long long)ans*inv[a-b])%mod;
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		int n,a,b,c;
		scanf(&quot;%d%d%d%d&quot;,&amp;n,&amp;a,&amp;b,&amp;c);
		int ans=0;
		ans=(ans+C(n+3,3))%mod;
		ans=(ans-C(n-a-1+3,3)+mod)%mod;
		ans=(ans-C(n-b-1+3,3)+mod)%mod;
		ans=(ans-C(n-c-1+3,3)+mod)%mod;
		ans=(ans+C(n-a-1-b-1+3,3))%mod;
		ans=(ans+C(n-a-1-c-1+3,3))%mod;
		ans=(ans+C(n-b-1-c-1+3,3))%mod;
		ans=(ans-C(n-a-1-b-1-c-1+3,3)+mod)%mod;
		printf(&quot;%d\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品m个人，每人至少分1个至多分a个</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
const int mod=998244353;

int qpow(int a,int b){
	a%=mod;
	int ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

long long C(long long a,long long b){
	if(b&gt;a || a&lt;0 || b&lt;0) return 0;
	long long ans;
	ans=((long long)f[a]*inv[b])%mod;
	ans=(ans*inv[a-b])%mod;
	return ans;
}

int main(){
	f[0]=1;
	inv[0]=1;
	for(int i=1;i&lt;=2000000;i++) f[i]=((long long)f[i-1]*i)%mod;
	for(int i=1;i&lt;=2000000;i++) inv[i]=qpow(f[i],mod-2);
	int t;
	cin&gt;&gt;t;
	while(t--){
		long long n,m,a;
		scanf(&quot;%lld%lld%lld&quot;,&amp;n,&amp;m,&amp;a);
		long long ans=0;
		long long sig=-1;
		for(int i=0;i&lt;=m;i++){
			sig=-sig;
			ans=(ans+(sig*((C(m,i)*C(n-i*a-1,m-1))%mod)+mod)%mod)%mod;
		}
		printf(&quot;%lld\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p>n个物品,m个人，第i个人至少分i个物品。<br>
物品数量1e9，需要分段打表<br>
每1000000个作为一段，先找到某一段的起始点存下来直接查表后再从该起点开始计算即可。</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;

int f[2000005];
int inv[2000005];
int base[]={1,595392237,994098667,364699203,568578178,353555276,493983122,906718537,121127074,909014738,945896249,342399609,790120527,147253931,67264528,790714464,189532209,833738102,931626412,151863245,826994544,481093241,932212199,731187718,767796707,605638460,958695288,771291337,590085129,446480069,147972654,350136354,373694116,227237896,97514572,140068258,53133250,845289612,72954666,36877369,718271290,449456491,379246062,817276949,534271093,384445058,389084505,867959402,952145269,958877809,311054462,412426956,844279367,740083353,416456072,118457308,416329418,142048503,643654954,643951383,848172652,791853697,520007859,878967378,762841202,570305432,713917629,11692343,205846393,905147505,487479281,972125219,678016718,484746409,350309690,695700125,713970818,583720832,126424592,25713030,181218541,82188970,989697798,602326140,459677495,59807900,689138366,44957896,888819701,800005439,225032295,624211688,547511989,196954736,199119222,306295040,910980912,474605685,84623561,963825048,464016596,953756759,536600821,881161978,184568840,906328577,82034877,943074294,830724750,688870120,303879624,213840689,570227860,914456594,368538553,140809956,220748012,744155485,852101189,611264038,711595889,792814350,975294274,848600022,343924424,314335513,465367007,176980096,361199635,208713699,801978400,451768574,300105126,862344307,125513337,768082522,322916689,809611624,277541931,630852905,274311861,187673498,539880032,311717293,472449704,653242584,498068555,252296198,363821284,742302802,262505243,61466981,423276274,872503756,247799911,116138354,383733698,425387704,13084878,533446507,197661226,524712423,228313145,33526971,802055000,27654656,863102494,562080061,16014076,794297633,560969645,419973417,77884032,437172123,297193207,99282379,234484360,263675940,126078806,402256206,59654808,432633334,325399309,809276166,357087064,921613763,526694283,316138501,678750759,746036991,844084429,182773758,171987279,186981318,226494117,697926519,501264723,174203892,979944216,838454217,63299249,446954988,973678486,22468573,797563226,73974893,7811805,141549107,648758305,551877892,656698209,14577434,648537396,321672967,490582127,402544298,383677592,222602878,335207692,192440082,745706197,624113557,123808157,34041106,153359445,291330079,472937961,306641884,230002032,17620570,782663844,648326974,40641926,919496066,156812438,216776143,771982491,293156514,108393392,647247774,722450722,828756035,296777468,292267840,113800523,848869015,536983436,606989542,139244082,615719226,437503635,793559065,89411865,731975481,916663471,303118346,802766503,815443393,825125398,103129214,974490943,187537789,317640466,991859661,353447868,48936855,29690011,794847444,463865,980160470,756414660,658969388,480314263,754477681,969920264,234792522,950393370,9447745,219942453,896955380,100919583,961268059,257469327,256874276,602365627,332446515,820649009,852123798,931366341,363907999,567153381,829287382,316346223,204961939,892519996,200218172,409447584,413759816,511398700,525424686,434731971,201655127,527555374,534794906,673507495,856245130,774101120,316483089,456128068,304654619,992060846,895759186,535475656,391328370,570367126,433478530,461728255,603820946,848514617,938410313,397327632,781599555,387140465,325988071,983792111,831072860,274348231,244781184,557916799,495793161,588176542,707818671,399615775,396614675,970475852,617930862,142739589,481058302,72381331,733049039,152285902,620495701,211702428,292557494,754934951,448280657,937708104,114944122,403777490,234007857,561146832,331194565,187621296,831153252,266665958,112619512,495003569,314735447,993669991,166588036,410851918,378056607,938214670,875914014,509839345,908559433,199330441,49979382,36988609,111999291,739984378,543681812,751797733,219169756,926165187,965929333,192013508,124287897,744235249,214142835,631617451,607439447,36894593,114499232,987645276,107847633,600387283,155188867,413413086,591533181,918814530,830813489,729210384,205051208,444664579,814708615,54373694,893137468,462169319,86850668,55395755,533476316,492646207,226225078,901380105,789027050,177181362,968738480,305676848,639555094,984167498,685479246,221841167,592384146,230433631,555498231,420397116,697327970,46120170,210986816,880949811,975742763,329617586,597332621,55112303,292856026,814595319,17505696,483002713,396971174,904643816,768219428,256284681,152997554,596845812,44432164,630791386,754488680,506741102,920451383,713793642,426508708,632541790,783981500,590850286,141366782,527699907,822616858,344354411,61669915,44666331,954114587,160369717,924245234,887359392,636881588,153741665,189035156,821628333,517544552,712775427,417098537,460892316,557654999,450746749,131822321,583409364,284898500,59972237,376745393,443688906,586798088,66114037,781232294,465856500,824502125,324523678,504497384,401826176,551318162,488198727,18062959,576088832,336329877,388353305,133376514,604434514,250436000,115227070,249909750,374504494,723812318,365320562,55028369,734795127,10297859,372761109,694638249,83989185,539182349,15814281,51128986,779724202,2316419,728360831,19763134,886768819,16531010,367140027,910158745,809754637,431204028,809872091,507143038,611973586,498284694,128965735,190884132,867295530,187957506,581403016,218215230,641795957,783681839,205848961,550668434,317343290,18537853,568791889,312146958,931134979,496041138,706649849,413599989,541140074,901017129,134917425,370928963,51552071,973730060,415434801,853819639,245567895,774482725,324993538,562216456,173600178,196955863,571957460,859557027,733417940,872992467,438241014,584325580,626308021,677428365,619727706,108646702,106873343,222985154,522329741,236067460,234993577,96915194,598303963,947968222,79192481,499192702,671902371,57627377,396654552,238290506,698968535,565719861,912077970,222633276,317855167,879270128,779281316,955106365,691138193,308501832,705116133,80804698,448274648,847238837,520429741,557547885,94096283,497936103,924037483,939432873,57780840,760085361,384575346,75784802,824151635,29501741,379498076,778852431,565294571,556952741,975088906,508647871,386440005,657590261,516827714,166179375,347645094,646791668,647279052,330524184,254602615,680643418,120278192,311672806,3419365,528266191,668433402,869010361,93888746,874764664,7678883,595828102,57261570,639380383,476079227,825433822,67314075,558200771,491863506,975190854,329289831,115085876,899090728,770171766,733423427,885411040,480959252,812588784,860288574,286559442,99042494,257048195,667673747,446642320,23426726,263781585,482321203,808698759,933267285,571158203,931650100,948732229,214316593,419100884,551572735,25545413,346054244,522774276,420593226,830119981,704867943,808652500,873443503,271941489,45004197,946541714,942010031,58788813,601485588,889162335,629629777,942066355,69680317,590458601,28415574,630884829,366933511,211402977,643768503,256301973,750822365,190901055,964782071,474044896,811223744,602838712,103215692,867156301,139726730,776840567,34257564,334413933,100841599,742905800,211983919,814705811,898907822,552939281,293833759,605216439,533706271,287490492,398448421,624299070,743951081,170411789,80606745,503624390,963402916,389692312,813390763,739515297,184376222,827065538,837221562,321295324,327597778,892731887,983736712,492798473,35984619,793708555,326086492,404364827,451702921,482632581,542573191,81652622,496456348,800081529,365229403,440120940,541283515,589831663,836513171,1622617,699711706,9822392,270369543,48502767,483818821,807306658,940195863,996802989,335498204,351302711,976125219,946799877,205793557,617335930,263016216,700471076,418289169,182905451,607010941,390184940,94136116,31679432,946545391,809891733,969973383,892136591,631298019,366867646,477362882,920685404,213289765,531334242,54554286,422615203,525372095,656468235,905676076,32225043,20265962,380486949,115141105,27242809,827540230,888356568,204724891,63636020,198164769,608600317,664039496,151223236,52175584,529818930,533325452,975804881,22859440,591906248,157158652,546572665,572396411,77285142,519470403,293988261,851627080,359416799,128854789,390105487,334196221,961139032,576755576,769092767,765332191,611040608,695240733,172879869,783994344,175402510,705142949,713972251,673925638,856907379,110202669,667250514,872441336,712476943,970085043,59198404,872316337,29604923,183874646,504806164,902310614,554327038,641905269,52061896,902200540,395872459,988111741,768505655,473627888,804695792,55347567,710946704,107293455,92200509,704829749,743343740,241780062,179458641,346163421,774005945,86267265,224283483,814887934,31123382,363309393,343021423,383938420,872523550,618586545,700288922,788490304,634936943,659546511,484554681,102530791,276464068,207521663,954340220,814858862,870757766,748435096,328536851,435069442,571887249,231026552,245087300,762391974,357151315,679385907,412917909,827211507,509717055,36312125,914806434,895628093,898484288,846605255,99876908,336853372,434699551,811027687,46877701,691840784,146433951,838191932,47148225,635728168,543329324,410255605,348561090,721576925,247694661,130777589,189684562,177693062,52290606,319328025,169326224,336263817,462250787,55202532,254949596,586041601,183721437,641794349,468267168,642753409,73501047,288998311,282501541,557408127,210177896,696055209,876411538,650287689,495452371,47816836,994758950,78276683,992027086,172330480,831774842,627965301,194786127,393313795,126452951,18783119,737013685,527689467,196339666,448659958,362583102,914253051,917575025,267644388,43344897,106852423,748022413,270862077,3180391,143673177,302944738,159075500,86074777,556910829,37844673,352544729,134136040,3833015,723939606,635470843,690636846,818001905,583087706,144748417,600846731,324917882,318644096,621611555,240286626,330730430,102463110,839514995,656215179,241972476,283521826,874936737,957091307,861277421,488484366,700680708,588885096,613224734,155777384,4060373,555779120,733506432,779114281,562668889,37746662,876240334,986766124,923597279,422941353,68201608,380597528,647180359,521561067,30193991,633380145,268768862};
const int mod=998244353;

long long qpow(long long a,long long b){
	a%=mod;
	long long ans=1;
	while(b){
		if(b&amp;1) ans=((long long)ans*a)%mod;
		b&gt;&gt;=1;
		a=((long long)a*a)%mod;
	}
	return ans;
}

long long fec(long long a){
	long long pos=a/1000000;
	long long bg=pos*1000000;
	long long ans=base[pos];
	for(long long i=bg+1;i&lt;=a;i++){
		ans=(ans*i)%mod;
	}
	return ans;
}

long long invc(long long a){
	return qpow(fec(a),mod-2);
}

long long C(long long a,long long b){
	if(b&gt;a || a&lt;0 || b&lt;0) return 0;
	long long ans;
	ans=(fec(a)*invc(b))%mod;
	ans=(ans*invc(a-b))%mod;
	return ans;
}

int main(){
	int t;
	cin&gt;&gt;t;
	while(t--){
		long long n,m;
		scanf(&quot;%lld%lld&quot;,&amp;n,&amp;m);
		for(int i=1;i&lt;=m;i++) n-=i;
		printf(&quot;%lld\n&quot;,C(n+m-1,m-1));
	}
	return 0;
}
</code></pre>

              </div>
              <div class="toc-container">
                
              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://938650141.github.io/post/mobius-han-shu/">
              <h3 class="post-title">
                Mobius函数
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  <a href="https://www.mfwztj.com/" target="_blank"><img src="https://www.mfwztj.com/hit.php?id=yvuxxf&nd=6&style=2" border="0" alt="网站计数器"></a>
  <a class="rss" href="https://938650141.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
